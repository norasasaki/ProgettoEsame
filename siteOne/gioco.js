var questionario = [   
   {  // domanda 1     
      domanda  :  [
                     "immagini/domandechat/chat1a.png", 
                     "immagini/domandechat/chat1b.png",
                     "immagini/domandechat/chat1c.png",
					 "immagini/domandechat/chat1d.png",
					 "immagini/domandechat/chat1e.png",
					 "immagini/domandechat/chat1f2b.png",
					 "immagini/domandechat/chat1g.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png"
                  ],
      risposte :  [                     
                     "Non faccio colazione",                     
					 "Latte e biscotti",
					 "Solo del caffè",
					 "Frutta o qualcosa di sano",
					 "Una colazione bilanciata"                  
                  ],      
      punteggi :  [                     
                     [1, 0, 0,0,0],                     
					 [0, 0, 1,0,0],
					 [0, 0, 0,0,1],  
					 [0, 1, 0,0,0],  
					 [0, 0, 0,1,0]               
                  ]   
   },   
   {  // domanda 2      
      domanda : [
                    "immagini/domandechat/chat2a.png", 
				    "immagini/domandechat/chat1f2b.png",
				    "immagini/domandechat/chat2c.png",
				    "immagini/domandechat/chat2d.png",
				    "immagini/domandechat/chat2e.png",
				    "immagini/domandechat/chat2f.png",
				    "immagini/domandechat/chat2g.png",
				    "immagini/domandechat/chat2h.png",
				    "immagini/domandechat/chat2i.png",
				    "immagini/domandechat/chat2l.png",
				    "immagini/domandechat/compensare1.png",
				    "immagini/domandechat/compensare1.png",
				    "immagini/domandechat/compensare1.png"
                  ],
      risposte :  [                     
                      "Al cinema o teatro",                     
					  "Ad un caffè",
					  "Appuntamento a casa",
					  "Cena in un ristorante",
					  "Qualcosa di divertente"                  
                  ],
      punteggi :  [                     
                     [0, 1, 0,0,0],                     
					 [0, 0, 0,0,1],
					 [0, 0, 1,0,0],
					 [0, 0, 0,1,0],                     
					 [1, 0, 0,0,0]                
                  ]  
    },  
    {  // domanda 3    
       domanda : [
                     "immagini/domandechat/chat3a.png", 
					 "immagini/domandechat/chat3b.png",
					 "immagini/domandechat/chat3c.png",
					 "immagini/domandechat/chat3d.png",
					 "immagini/domandechat/chat3e.png",
					 "immagini/domandechat/chat3f.png",
					 "immagini/domandechat/chat3g.png",
					 "immagini/domandechat/chat3h.png",
					 "immagini/domandechat/chat3i.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png"
                  ],
      risposte :  [                     
                     "Cucinare",                    
					 "Giocare ai videogames",   
					 "Leggere o scrivere",
					 "Qualcosa di artistico",
					 "Navigare in internet"                  
                  ],      
      punteggi :  [                     
                     [0, 0, 0,0,1],                     
					 [0, 0, 1,0,0],
					 [0, 0, 0,1,0],
					 [0, 1, 0,0,0],  
					 [1, 0, 0,0,0]                 
                  ]   
   },   
   {  // domanda 4      
      domanda : [   
                     "immagini/domandechat/chat4a.png", 
				     "immagini/domandechat/chat4b.png",
				     "immagini/domandechat/chat4c.png",
				     "immagini/domandechat/chat4d.png",
				     "immagini/domandechat/chat4e.png",
				     "immagini/domandechat/chat4f.png",
				     "immagini/domandechat/chat4g.png",
				     "immagini/domandechat/chat4h.png",
				     "immagini/domandechat/chat4i.png",
				     "immagini/domandechat/chat4l.png",
				     "immagini/domandechat/compensare1.png",
				     "immagini/domandechat/compensare1.png",
				     "immagini/domandechat/compensare1.png"
                  ],
      risposte :  [                     
                      "Faccio dei regali",                     
					  "Aiuto con il lavoro",
					  "Parole di incoraggiamento",  
					  "Passo del tempo con loro", 
					  "Uso il contatto fisico"                 
                  ],      
      punteggi :  [                     
                     [0, 0, 0,1,0],                     
					 [0, 0, 0,0,1],
					 [0, 0, 1,0,0], 
					 [1, 0, 0,0,0],       
					 [0, 1, 0,0,0]                 
                  ]   
   },
   {  // domanda 5      
      domanda :  [
                     "immagini/domandechat/chat5a.png", 
					 "immagini/domandechat/chat5b.png",
					 "immagini/domandechat/chat5c.png",
					 "immagini/domandechat/chat5d.png",
					 "immagini/domandechat/chat5e.png",
					 "immagini/domandechat/chat5f.png",
					 "immagini/domandechat/chat5g.png",
					 "immagini/domandechat/chat5h.png",
					 "immagini/domandechat/chat5i.png",
					 "immagini/domandechat/chat5l.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png",
					 "immagini/domandechat/compensare1.png"
                  ],
      risposte :  [                     
                     "Azione",                     
					 "Drama",
					 "Musical",
					 "Fantascienza",      
					 "Documentari"                 
                  ],      
      punteggi :  [                     
                     [0, 0, 1,0,0],                     
					 [0, 0, 0,0,1],
					 [0, 1, 0,0,0],  
					 [1, 0, 0,0,0],                    
					 [0, 0, 0,1,0]                 
                  ]   
   }, 
   {  // domanda 6     
      domanda :  [
                     "immagini/domandechat/chat6a.png", 
					 "immagini/domandechat/chat6b.png",
					 "immagini/domandechat/chat6c.png",
					 "immagini/domandechat/chat6d.png",
					 "immagini/domandechat/chat6e.png",
					 "immagini/domandechat/chat6f.png",
					 "immagini/domandechat/chat6g.png",
					 "immagini/domandechat/chat6h.png",
					 "immagini/domandechat/chat6i.png",
					 "immagini/domandechat/chat6h.png",
					 "immagini/domandechat/chat6l.png",
					 "immagini/domandechat/chat6m.png",
					 "immagini/domandechat/chat6n.png",
					 "immagini/domandechat/chat6o.png"
                  ],
      risposte :  [                     
                     "Gatto",                     
					 "Qualsiasi animale",
					 "Cane",
					 "Un gatto robot o il longcat",                    
					 "Basta non necessiti molte cure"                 
                  ],      
      punteggi :  [                     
                     [0, 0, 0,1,0],                     
					 [0, 0, 1,0,0],
					 [0, 1, 0,0,0],  
					 [0, 0, 0,0,0],                    
					 [0, 0, 0,0,1]                     
                  ]   
 } 
 ]

var nodoScelte;
var nodoFinale;
var nodoNumeroDomanda;
var nodoTestoDomanda;
var nodoRisposta0;
var nodoTestoRisposta0;
var nodoRisposta1;
var nodoTestoRisposta1;
var nodoRisposta2;
var nodoTestoRisposta2;
var nodoRisposta3;
var nodoTestoRisposta3;
var nodoRisposta4;
var nodoTestoRisposta4;
var nodoAvanti;
var nodoRisultato;
var nodoInizia;

var numeroDomande;
var numeroDomandaCorrente;
var risposteDate;
var matriceAffinita;
var automatico = true;
var a = 0;
var b = 0;

function gestoreLoad () {
   try {
	  nodoScelte = document.getElementById("scelte")
	  nodoFinale = document.getElementById("finale");
	  nodoRisposta3 = document.getElementById("risposta3");
      nodoTestoRisposta3 = document.getElementById("testoRisposta3");
	  nodoRisposta4 = document.getElementById("risposta4");
      nodoTestoRisposta4 = document.getElementById("testoRisposta4");
/**/  nodoNumeroDomanda = document.getElementById("numeroDomanda");
/**/  nodoTestoDomanda = document.getElementById("testoDomanda");
/**/  nodoRisposta0 = document.getElementById("risposta0");
/**/  nodoTestoRisposta0 = document.getElementById("testoRisposta0");
/**/  nodoRisposta1 = document.getElementById("risposta1");
/**/  nodoTestoRisposta1 = document.getElementById("testoRisposta1");
/**/  nodoRisposta2 = document.getElementById("risposta2");
/**/  nodoTestoRisposta2 = document.getElementById("testoRisposta2");
/**/  nodoAvanti = document.getElementById("avanti");
/**/  nodoRisultato = document.getElementById("risultato");
/**/  nodoInizia = document.getElementById("inizia");
/**/  nodoAvanti.onclick = gestoreClickAvanti;
/**/  nodoInizia.onclick = gestoreClickInizia;
/**/  numeroDomande = questionario.length;
/**/  creaAffinita();
/**/  nuovoQuestionario();
   } catch ( e ) {
      alert ("gestoreLoad " + e);
   }
}
window.onload = gestoreLoad;

//rimuove tutti figli di Domanda
function rimozione () {
   while (nodoTestoDomanda.childNodes.length > 0) {
		 nodoTestoDomanda.removeChild(nodoTestoDomanda.firstChild);
   }
   while (nodoFinale.childNodes.length > 0) {
		 nodoFinale.removeChild(nodoFinale.firstChild);
   }
}

//Crea nuovo questionario azzerando tutto
/**/function nuovoQuestionario () {
/**/   numeroDomandaCorrente = 0;
/**/   aggiornaDomanda(numeroDomandaCorrente);
/**/   scriviMessaggio(nodoRisultato, "");
       scriviMessaggio(nodoFinale, "");
/**/   risposteDate = [];
/**/   matriceAffinita = [];
       nodoScelte.setAttribute("style", "display:none");
/**/}

//Cambia testo della domanda(setAutomatico) e risposte
/**/function aggiornaDomanda (i) {   
/**/   scriviMessaggio(nodoNumeroDomanda,                   
/**/                   "Domanda " + (i + 1) + " di " + numeroDomande);   
/**/   var parte = questionario[i]; 
/**/   scriviMessaggio(nodoTestoRisposta0, parte.risposte[0]);   
/**/   scriviMessaggio(nodoTestoRisposta1, parte.risposte[1]);   
/**/   scriviMessaggio(nodoTestoRisposta2, parte.risposte[2]);
       scriviMessaggio(nodoTestoRisposta3, parte.risposte[3]);
	   scriviMessaggio(nodoTestoRisposta4, parte.risposte[4]); 
       setAutomatico();
/**/   nodoRisposta0.checked = false;   
/**/   nodoRisposta1.checked = false;   
/**/   nodoRisposta2.checked = false; 
       nodoRisposta3.checked = false;
       nodoRisposta4.checked = false;
/**/} 

//creano i nodi delle varie parti domanda
function scriviDomanda (x) {
   var parti2 = questionario[b];
   var messaggio = parti2.domanda;
   if (a == 11) {
	  nodoScelte.setAttribute("style", "display:display");
   }
   if (messaggio.length > a) {
	  var nodoParteDomanda = document.createElement("img");
      nodoTestoDomanda.appendChild(nodoParteDomanda);
	  nodoParteDomanda.setAttribute("src", messaggio[a]);
	  a += x;
   }
}

//crea i figli di Domanda ogni x tempo
/**/function setAutomatico () {
/**/   try {   
/**/      if (automatico) {     
/**/         scriviDomanda(+1); 
/**/         setTimeout(setAutomatico, 1080);
/**/      } 
/**/   } catch ( e ) {  
/**/      alert("setAutomatico " + e);  
/**/   } 
/**/}

//base per scrivere risposte
/**/function scriviMessaggio (nodo, messaggio) {
/**/   var nodoTesto = document.createTextNode(messaggio);
/**/   if (nodo.childNodes.length == 0) {
/**/      nodo.appendChild(nodoTesto);
/**/   } else {
/**/      nodo.replaceChild(nodoTesto, nodo.firstChild);
/**/   }
/**/}

//aggiorna la domanda o restituisce il risultato
/**/function gestoreClickAvanti () {
/**/   try {
/**/      if (numeroDomandaCorrente == numeroDomande) {
/**/         return;
/**/	  }
/**/      if (nodoRisposta0.checked) {
/**/         risposteDate[numeroDomandaCorrente] = 0;
/**/      } else if (nodoRisposta1.checked) {
/**/         risposteDate[numeroDomandaCorrente] = 1;
/**/      } else if (nodoRisposta2.checked) {
/**/         risposteDate[numeroDomandaCorrente] = 2;
/**/      } else if (nodoRisposta3.checked) {
/**/         risposteDate[numeroDomandaCorrente] = 3;
/**/      } else if (nodoRisposta4.checked) {
/**/         risposteDate[numeroDomandaCorrente] = 4;
/**/      } else {
/**/         return;
/**/      }
/**/      numeroDomandaCorrente++;
/**/      if (numeroDomandaCorrente == numeroDomande) {
/**/         var esito = calcolaEsito();
/**/         var s, z, w;
             if (esito == 0) {
                s = profili[esito].immagine ;
				z = profili[esito].nome;
				w = profili[esito].pagina;
             } else if(esito==1){
                s = profili[esito].immagine;
				z = profili[esito].nome;
				w = profili[esito].pagina;
             } else if (esito ==2){
				s = profili[esito].immagine;
				z = profili[esito].nome;
				w = profili[esito].pagina;
			 } else if (esito ==3){
				s = profili[esito].immagine;
				z = profili[esito].nome;
				w = profili[esito].pagina;
			 } else if (esito ==4){
				s = profili[esito].immagine;
				z = profili[esito].nome;
				w = profili[esito].pagina;
			 }
			 scriviFinaleB(z);
             scriviFinale(nodoRisultato, s, w);
			 nascondi();
          } else {
			 rimozione();
			 nodoScelte.setAttribute("style", "display:none");
			 a = 0;
			 b++;
             aggiornaDomanda(numeroDomandaCorrente);
			 automatico = true;
         }
      } catch ( e ) {
         alert ("gestoreClickAvanti " + e);
      }
}

//scrive il risultato
function scriviFinale (nodo, messaggio, pagina) {
   var nodoRisultatoF = document.createElement("a");
	   nodoRisultatoF.setAttribute("href", pagina);
   var nodoImmagine = document.createElement("img")
	   nodoImmagine.setAttribute("src", messaggio);
	   nodoRisultatoF.appendChild(nodoImmagine);
/**/if (nodo.childNodes.length == 0) {
/**/   nodo.appendChild(nodoRisultatoF);
/**/} else {
/**/   nodo.replaceChild(nodoRisultatoF, nodo.firstChild);
/**/}
}

//scrive frase sopra risultato
function scriviFinaleB (messaggio2) {
	var nodoRisultatoF2 = document.createTextNode("La tua affinnità maggiore è con:");
	var nodoRisultatoZ = document.createTextNode(messaggio2)
/**/if (nodoFinale.childNodes.length == 0) {
/**/   nodoFinale.appendChild(nodoRisultatoF2);
       nodoFinale.appendChild(nodoRisultatoZ);
/**/} else {
/**/   nodoFinale.replaceChild(nodoRisultatoF2, nodoFinale.firstChild);
       nodoFinale.appendChild(nodoRisultatoZ);
/**/}
}

//nasconde domande e risposte 
function nascondi () {
	nodoTestoDomanda.setAttribute("style", "display:none");
    nodoScelte.setAttribute("style", "display:none");
}
//mostra domande e risposte
function mostra () {
	nodoTestoDomanda.setAttribute("style", "display:display")
    nodoScelte.setAttribute("style", "display:display");
 }

//forma le vettori di affinità per risposta scandendo il questionario poi fatta la somma
/**/function creaAffinita () {   
/**/   for (var i = 0; i < questionario.length; i++) {      
/**/      var parte = questionario[i];      
/**/      var punteggiRisposte = parte.punteggi;     
/**/      var affinitaRisposte = [];      
/**/      for (var j = 0; j < punteggiRisposte.length; j++) {         
/**/         var punteggiRisposta = punteggiRisposte[j];         
/**/         var sommaPunteggi = 0;         
/**/         for (var k = 0; k < punteggiRisposta.length; k++) {            
/**/            sommaPunteggi += punteggiRisposta[k];         
/**/         }         
/**/         var affinitaRisposta = [];         
 /**/        for (var k = 0; k < punteggiRisposta.length; k++) {            
/**/            affinitaRisposta[k] = punteggiRisposta[k] / sommaPunteggi;         
/**/         }         
/**/         affinitaRisposte[j] = affinitaRisposta;      
/**/      }      
/**/      questionario[i].affinita = affinitaRisposte;   
/**/   } 
/**/ } 

//calcola il punteggio più alto tra le verie matrici di affinità
/**/function calcolaEsito () {   
/**/   for (var i = 0; i < questionario.length; i++) {      
/**/      var parte = questionario[i];      
/**/      var rispostaData = risposteDate[i];      
/**/      matriceAffinita[i] = parte.affinita[rispostaData];   
/**/   }  
/**/   var affinitaQuestionario = [];   
/**/   for (var i = 0; i < profili.length; i++) {     
/**/      affinitaQuestionario[i] = 0;   
/**/   }   
/**/   for (var i = 0; i < matriceAffinita.length; i++) {     
/**/      var vettoreAffinita = matriceAffinita[i];      
/**/      for (var j = 0; j < vettoreAffinita.length; j++) {         
/**/         affinitaQuestionario[j] += vettoreAffinita[j];      
/**/      }   
/**/   }   
/**/   var indiceMax = 0;   
/**/   for (var i = 0; i < affinitaQuestionario.length; i++) {      
/**/      if (affinitaQuestionario[i] > affinitaQuestionario[indiceMax]) {
/**/	     indiceMax = i;      
/**/	  }   
/**/   }   
/**/   return indiceMax; 
/**/} 

//resetta variabili globali e chiama nuovoquestionario
/**/function gestoreClickInizia () {
/**/   try {
	      rimozione();
	      b = 0;
	      a = 0;
		  mostra();
/**/      nuovoQuestionario();
/**/   } catch ( e ) {
/**/      alert ("gestoreClickInizia " + e);
/**/   }
/**/}

/**/var profili = [
    {
        nome : "Seven",
        immagine: "immagini/provab1.gif",
        pagina : "sevenscheda.html",	//seven
    },
    {
       nome : "Zen",
       immagine: "immagini/provab2.gif",
	   pagina : "zenscheda.html",//zen
    },
    {
       nome : "Yossung",
       immagine: "immagini/provab3.gif",
	   pagina : "yoosungscheda.html",//Yoosung
    },
    {
       nome : "Jumin",
       immagine: "immagini/provab4.gif", 
	   pagina : "juminscheda.html",//Jumin
    },
    {
       nome : "Jeahee",
       immagine: "immagini/provab5.gif",
	   pagina : "jeaheescheda.html"//Jeahee
    }
]

